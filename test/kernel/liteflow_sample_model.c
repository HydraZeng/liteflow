/****************** main.c for model 2333 generated by nn-loader.py *******************/
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/version.h>
#include <linux/slab.h>

#include "linux/liteflow.h"


/************************************** Layer 0 **************************************/
static void fc_0_comp (s64 *input, s64 *output)
{
    
    output[0] =input[0] * 48 + input[1] * -63 + input[2] * -50 + input[3] * 75+  228;
    
    output[1] =input[0] * 99 + input[1] * 10 + input[2] * -102 + input[3] * 53+  235;
    
    output[2] =input[0] * 44 + input[1] * -61 + input[2] * -3 + input[3] * 67+  255;
    
    output[3] =input[0] * 115 + input[1] * -12 + input[2] * -47 + input[3] * 108+  255;
    
    output[4] =input[0] * -108 + input[1] * 2 + input[2] * 61 + input[3] * -127+  86;
    
    output[5] =input[0] * -91 + input[1] * 8 + input[2] * -39 + input[3] * -101+  224;
    
    output[6] =input[0] * -9 + input[1] * 62 + input[2] * 59 + input[3] * -125+  255;
    
    output[7] =input[0] * -98 + input[1] * -57 + input[2] * 14 + input[3] * -94+  255;
    
}

struct model_layer layer_0 __read_mostly = {
    .uuid = 0,
    .input_size = 4,
    .output_size = 8,
    .comp_func = fc_0_comp,
};
/************************************ End Layer 0 ************************************/

/************************************** Layer 1 **************************************/
static void fc_1_comp (s64 *input, s64 *output)
{
    
    output[0] =input[0] * 96 + input[1] * 115 + input[2] * 127 + input[3] * 77 + input[4] * -101 + input[5] * -50 + input[6] * -112 + input[7] * -39+  91;
    
}

struct model_layer layer_1 __read_mostly = {
    .uuid = 1,
    .input_size = 8,
    .output_size = 1,
    .comp_func = fc_1_comp,
};
/************************************ End Layer 1 ************************************/


/************************************** Model  **************************************/

struct model_container model_2333 __read_mostly = {
    .uuid = 2333,
    .input_size = 4,
    .output_size = 1,
};

static int
__init liteflow_2333_model_init(void)
{
    lf_register_model(1, &model_2333);

    // Construct
    INIT_LIST_HEAD(&model_2333.layers);
    list_add(&layer_0.list, &model_2333.layers);
    list_add(&layer_1.list, &layer_0.list);
    
    return 0;
}

static void
__exit liteflow_2333_model_exit(void)
{
    lf_unregister_model(1, 2333);
}

module_init(liteflow_2333_model_init);
module_exit(liteflow_2333_model_exit);

MODULE_DESCRIPTION("liteflow 2333 model");
MODULE_AUTHOR("Junxue ZHANG");
MODULE_LICENSE("GPL v2");

/************************************ End Model  ************************************/